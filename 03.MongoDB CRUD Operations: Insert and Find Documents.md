# Insert and Find Documents

You built queries by using the following comparison operators:

- $gt (greater than)
- $lt (less than)
- $lte (less than or equal to)
- $gte (greater than or equal to)

You also used the following logical operators:

- $and
- $or

## Insert

### [db.collection.insertOne()](https://www.mongodb.com/docs/manual/reference/method/db.collection.insertOne/?_ga=2.261124036.810066485.1665291537-836515500.1666025886#db.collection.insertone--)

#### Syntax
```
db.collection.insertOne(
    <document>,
    {
      writeConcern: <document>
    }
)
```

#### Examples
- Insert a Document without Specifying an _id Field


    In the following example, the document passed to the insertOne() method does not contain the _id field:

    ```
    try {
      db.products.insertOne( { item: "card", qty: 15 } );
    } catch (e) {
      print (e);
    };
    ```

- Insert a Document Specifying an _id Field
    
    In the following example, the document passed to the `insertOne()` method includes the _id field. The value of _id must be unique within the collection to avoid duplicate key error.

    ```
    try {
      db.products.insertOne( { _id: 10, item: "box", qty: 20 } );
    } catch (e) {
      print (e);
    }
    ```

### [db.collection.insertMany()](https://www.mongodb.com/docs/manual/reference/method/db.collection.insertMany/?_ga=2.86565841.810066485.1665291537-836515500.1666025886#db.collection.insertmany--)


#### Syntax

```
db.collection.insertMany(
   [ <document 1> , <document 2>, ... ],
   {
      writeConcern: <document>,
      ordered: <boolean>
   }
)
```

#### Examples

- Insert Several Document without Specifying an _id Field

    The following example uses db.collection.insertMany() to insert documents that do not contain the _id field:

    ```
    try {
        db.products.insertMany( [
            { item: "card", qty: 15 },
            { item: "envelope", qty: 20 },
            { item: "stamps" , qty: 30 }
        ] );
    } catch (e) {
        print (e);
    }
    ```

- Insert Several Document Specifying an _id Field

    The following example/operation uses insertMany() to insert documents that include the _id field. The value of _id must be unique within the collection to avoid a duplicate key error.
    
    ```
    try {
        db.products.insertMany( [
            { _id: 10, item: "large box", qty: 20 },
            { _id: 11, item: "small box", qty: 55 },
            { _id: 12, item: "medium box", qty: 30 }
        ] );
    } catch (e) {
        print (e);
    }
    ```

- Unordered Inserts

    The following attempts to insert multiple documents with _id field and ordered: false. The array of documents contains two documents with duplicate _id fields.

    ```
    try {
        db.products.insertMany( [
            { _id: 10, item: "large box", qty: 20 },
            { _id: 11, item: "small box", qty: 55 },
            { _id: 11, item: "medium box", qty: 30 },
            { _id: 12, item: "envelope", qty: 100},
            { _id: 13, item: "stamps", qty: 125 },
            { _id: 13, item: "tape", qty: 20},
            { _id: 14, item: "bubble wrap", qty: 30}
        ], { ordered: false } );
    } catch (e) {
        print (e);
    }
    ```

- Using Write Concern

    Given a three member replica set, the following operation specifies a w of majority and wtimeout of 100:

    ```
    try {
        db.products.insertMany(
            [
                { _id: 10, item: "large box", qty: 20 },
                { _id: 11, item: "small box", qty: 55 },
                { _id: 12, item: "medium box", qty: 30 }
            ],
            { w: "majority", wtimeout: 100 }
        );
    } catch (e) {
        print (e);
    }
    ```

## Find

### [db.collection.find()](https://www.mongodb.com/docs/manual/reference/method/db.collection.find/?_ga=2.86565841.810066485.1665291537-836515500.1666025886#db.collection.find--)

#### Syntax

```
db.collection.find( <query>, <projection>, <options> )
```

#### Examples

The examples in this section use documents from the [bios collection](https://www.mongodb.com/docs/manual/reference/bios-example-collection/#std-label-bios-example-collection) where the documents generally have the form:

```
{
    "_id" : <value>,
    "name" : { "first" : <string>, "last" : <string> },       // embedded document
    "birth" : <ISODate>,
    "death" : <ISODate>,
    "contribs" : [ <string>, ... ],                           // Array of Strings
    "awards" : [
        { "award" : <string>, year: <number>, by: <string> }  // Array of embedded documents
        ...
    ]
}
```

To create and populate the bios collection, see [bios collectio](https://www.mongodb.com/docs/manual/reference/bios-example-collection/#std-label-bios-example-collection).

- Find All Documents in a Collection

    The find() method with no parameters returns all documents from a collection and returns all fields for the documents. For example, the following operation returns all documents in the bios collection:

    ```
    db.bios.find()
    ```

- Find Documents that Match Query Criteria

    - The following operation returns documents in the bios collection where _id equals 5:

        ```
        db.bios.find( { _id: 5 } )
        ```

    - The following operation returns documents in the bios collection where the field last in the name embedded document equals "Hopper":

        ```
        db.bios.find( { "name.last": "Hopper" } )
        ```

- Query Using Operators

    - The following operation uses the $in operator to return documents in the bios collection where _id equals either 5 or ObjectId("507c35dd8fada716c89d0013"):

        ```
        db.bios.find(
        { _id: { $in: [ 5, ObjectId("507c35dd8fada716c89d0013") ] } }
        )
        ```

    - The following operation uses the $gt operator returns all the documents from the bios collection where birth is greater than new Date('1950-01-01'):

        ```
        db.bios.find( { birth: { $gt: new Date('1950-01-01') } } )
        ```

    - The following operation uses the $regex operator to return documents in the bios collection where name.last field starts with the letter N (or is "LIKE N%")

        ```
        db.bios.find(
            { "name.last": { $regex: /^N/ } }
        )
        ```

- Query for Ranges

    - Combine comparison operators to specify ranges for a field. The following operation returns from the bios collection documents where birth is between new Date('1940-01-01') and new Date('1960-01-01') (exclusive):

        ```
        db.bios.find( { birth: { $gt: new Date('1940-01-01'), $lt: new Date('1960-01-01') } } )
        ```

- Query for Multiple Conditions

    - The following operation returns all the documents from the bios collection where birth field is greater than new Date('1950-01-01') and death field does not exists:

        ```
        db.bios.find( {
            birth: { $gt: new Date('1920-01-01') },
            death: { $exists: false }
        } )
        ```

- Compare Two Fields from A Single Document

    $expr can contain expressions that compare fields from the same document.

    Create a monthlyBudget collection with these documents:

    ```
    db.monthlyBudget.insertMany( [
        { _id : 1, category : "food", budget : 400, spent : 450 },
        { _id : 2, category : "drinks", budget : 100, spent : 150 },
        { _id : 3, category : "clothes", budget : 100, spent : 50 },
        { _id : 4, category : "misc", budget : 500, spent : 300 },
        { _id : 5, category : "travel", budget : 200, spent : 650 }
    ] )
    ```

    The following operation uses $expr to find documents where the spent amount exceeds the budget:

    ```
    db.monthlyBudget.find( { $expr: { $gt: [ "$spent" , "$budget" ] } } )
    ```

- Query Embedded Documents

    - Query Exact Matches on Embedded Documents

        The following operation returns documents in the bios collection where the embedded document name is exactly { first: "Yukihiro", last: "Matsumoto" }, including the order:

        ```
        db.bios.find(
            { name: { first: "Yukihiro", last: "Matsumoto" } }
        )
        ```

        The name field must match the embedded document exactly. The query does not match documents with the following name fields:

        ```
        {
        first: "Yukihiro",
        aka: "Matz",
        last: "Matsumoto"
        }

        {
        last: "Matsumoto",
        first: "Yukihiro"
        }
        ```
